<!DOCTYPE html><html lang="en-US" mode="light" ><head> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-proxy-endpoint" content="https://myochosite-291718.appspot.com/query?id=ahNwfm15b2Nob3NpdGUtMjkxNzE4chULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="pv-cache-path" content="/true"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="CommandList - SSH" /><meta property="og:locale" content="en_US" /><meta name="description" content="SSH" /><meta property="og:description" content="SSH" /><link rel="canonical" href="https://ocholuo.github.io//posts/Linux.SSH/" /><meta property="og:url" content="https://ocholuo.github.io//posts/Linux.SSH/" /><meta property="og:site_name" content="Grace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-16T11:11:11-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CommandList - SSH" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"SSH","headline":"CommandList - SSH","dateModified":"2020-07-16T11:11:11-04:00","url":"https://ocholuo.github.io//posts/Linux.SSH/","datePublished":"2020-07-16T11:11:11-04:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ocholuo.github.io//posts/Linux.SSH/"},"@context":"https://schema.org"}</script><title>CommandList - SSH | Grace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Grace"><meta name="application-name" content="Grace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://myochosite-291718.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://myochosite-291718.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script async src="/assets/js/dist/pvreport.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-179830187-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-179830187-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/rabbit.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Grace</a></div><div class="site-subtitle font-italic">2021 Jun 22 updated</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ocholuo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>CommandList - SSH</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>CommandList - SSH</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Grace JyL </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 16, 2020, 11:11 AM -0400" prep="on" > Jul 16, 2020 <i class="unloaded">2020-07-16T11:11:11-04:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="9898 words">54 min</span> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin fa-fw"></i></span></div></div><div class="post-content"><h1 id="ssh">SSH</h1><p>[toc]</p><h2 id="ssh-用法及命令"><code class="language-plaintext highlighter-rouge">ssh</code> 用法及命令</h2><p>ref: http://www.cnblogs.com/voidy/ https://blog.csdn.net/pipisorry/article/details/52269785 http://www.ruanyifeng.com/blog/2011/12/ssh_port_forwarding.html https://linux.cn/article-3858-1.html</p><p><a href="http://www.sshcommands.co.uk/">SSH Commands</a></p><hr /><p>SSH is capable of</p><ul><li>shell access,<li>file transfers,<li>executing remote commands,<li>port forwarding and tunneling,<li>creating VPNs,<li>forwarding x displays, that’s our GUI,<li>encrypted proxy browsing (via socks protocol),<li>mounting remote directories.</ul><p>Execute commands <code class="language-plaintext highlighter-rouge">ssh user@hostname [command]</code></p><p>Copying files:</p><ul><li>sftp – secure ftp<li><code class="language-plaintext highlighter-rouge">scp fileName user@host:/home/user/fileName</code><li>Based on sftp, but meant to replace rcp</ul><p>Authentication Mechanisms</p><ul><li>Password<li>Public-key<li>Keyboard-interactive<li>Multiple passwords required (SecurID, etc.)<li>GSSAPI (Generic Security Services Application Program Interface)<li>Extensible to provide for Kerberos, NTLM, etc.</ul><hr /><ul><li>SSH是一种网络协议，用于计算机之间的加密登录。<li>如果一个用户从本地计算机，使用SSH协议登录另一台远程计算机，就可以认为这种登录是安全的，即使被中途截获，密码也不会泄露。<li>最早的时候，互联网通信都是明文通信，一旦被截获，内容就暴露无疑。1995年，芬兰学者Tatu Ylonen设计了SSH协议，将登录信息全部加密，成为互联网安全的一个基本解决方案，迅速在全世界获得推广，目前已经成为Linux系统的标准配置。<li>SSH只是一种协议，存在多种实现，既有商业实现，也有开源实现。<li>本文针对的实现是OpenSSH，它是自由软件，应用非常广泛。<li>这里只讨论SSH在Linux Shell中的用法。<li><p>在Windows系统中使用SSH，会用到另一种软件PuTTY，这需要另文介绍。</p><li>SSH之所以能够保证安全，原因在于它采用了公钥加密。<li>整个过程是这样的：<ol><li>远程主机收到用户的登录请求，远程主机把自己的公钥发给用户。<li>用户使用这个公钥，将登录密码加密后，发送回来。<li>远程主机用自己的私钥，解密登录密码，如果密码正确，就同意用户登录。</ol><li>这个过程本身是安全的，但是实施的时候存在一个风险：<em>MITM</em><ul><li>如果有人截获了登录请求，然后冒充远程主机，将伪造的公钥发给用户，那么用户很难辨别真伪。<li>因为不像https协议，SSH协议的公钥是没有证书中心（CA）公证的，也就是说，都是自己签发的。<li>设想攻击者插在用户与远程主机之间（比如在公共的wifi区域），用伪造的公钥，获取用户的登录密码。再用这个密码登录远程主机，那么SSH的安全机制就荡然无存了。这种风险就是（Man-in-the-middle attack）</ul></ul><h2 id="ssh的安装">ssh的安装</h2><ul><li>SSH分<code class="language-plaintext highlighter-rouge">客户端openssh-client</code>和<code class="language-plaintext highlighter-rouge">openssh-server</code><ul><li>如果只想登陆别的机器的SSH, 只需要安装openssh-client<li>如果要使本机开放SSH服务, 需要安装openssh-server</ul><li>Ubuntu已经安装了ssh client<ul><li>如果没有则<code class="language-plaintext highlighter-rouge">sudo apt-get install openssh-client</code></ul></ul><hr /><h2 id="配置ssh">配置ssh</h2><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s">"</span><span class="se">\033</span><span class="s">[31;1m ******************************* </span><span class="se">\033</span><span class="s">[0m"</span>
<span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s">"</span><span class="se">\033</span><span class="s">[31;1m ************安装和配置ssh************ </span><span class="se">\033</span><span class="s">[0m"</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">openssh</span><span class="o">-</span><span class="n">server</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
<span class="n">sudo</span> <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s">'s/UsePAM no/UsePAM yes/g'</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span>
<span class="n">sudo</span> <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s">'8a /etc/init.d/ssh start'</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">ssh</span> <span class="n">start</span>
<span class="n">ps</span> <span class="o">-</span><span class="n">e</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">ssh</span>

<span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s">"</span><span class="se">\033</span><span class="s">[31;1m ssh授权 </span><span class="se">\033</span><span class="s">[0m"</span>
<span class="n">cd</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span>
<span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span>
<span class="n">cat</span> <span class="p">.</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="o">/</span><span class="n">authorized_keys</span>

<span class="err">$</span> <span class="n">ps</span> <span class="o">-</span><span class="n">e</span><span class="o">|</span><span class="n">grep</span> <span class="n">ssh</span>
<span class="err"> </span><span class="mi">2151</span> <span class="err">?       </span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">ssh</span><span class="o">-</span><span class="n">agent</span>

<span class="err"> </span><span class="mi">5313</span> <span class="err">?       </span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">sshd</span>

<span class="n">ssh</span><span class="o">-</span><span class="n">agent表示ssh</span><span class="o">-</span><span class="n">client启动</span><span class="err">，</span><span class="n">sshd表示ssh</span><span class="o">-</span><span class="n">server启动了</span><span class="err">。</span>

<span class="n">如果缺少sshd</span><span class="err">，</span><span class="n">说明ssh服务没有启动或者没有安装</span><span class="err">。</span>

<span class="mf">2.</span>
<span class="n">如果你需要改变</span> <span class="n">SSH</span> <span class="n">的配置</span><span class="p">,</span> <span class="n">用文本编辑器打开</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span> <span class="n">进行编辑</span><span class="p">.</span>
<span class="n">比如改变登陆的标语</span><span class="p">,</span> <span class="n">在配置文件中找到下面这行</span><span class="p">:</span>
<span class="c1">#Banner none
</span><span class="n">删除</span> <span class="s">"#"</span> <span class="n">字符</span><span class="p">(</span><span class="n">取消该行的注释</span><span class="p">),</span> <span class="n">将</span> <span class="n">none</span> <span class="n">替换为包含你期望显示内容的文件地址</span><span class="p">.</span>
<span class="n">修改后该行应该类似这样</span><span class="p">:</span>
<span class="n">Banner</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">issue</span>
<span class="n">在配置文件</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span> <span class="n">中你还可以找到端口号</span><span class="p">,</span> <span class="n">空闲超时时间等配置项</span><span class="p">.</span> <span class="n">配置项大都比较容易理解</span><span class="p">,</span> <span class="n">但是保险起见在你修改一些不是很确定的配置项时最好参考下</span> <span class="n">SSH</span> <span class="n">的帮助文档</span><span class="p">.</span>
</pre></table></code></div></div><h2 id="使用ssh在远程后台不中断地跑程序">使用ssh在远程后台不中断地跑程序</h2><ul><li>Linux关闭ssh（关闭终端等）后运行的程序或者服务自动停止，如python3 a.py &amp;。<li>解决：使用<code class="language-plaintext highlighter-rouge">nohup</code>命令让程序在关闭窗口（切换SSH连接）的时候程序还能继续在后台运行。<li><code class="language-plaintext highlighter-rouge">nohup python3 a.py &amp;</code></ul><h2 id="ssh-服务器端把空闲连接断开">ssh 服务器端把空闲连接断开</h2><ul><li>ssh连接中断: 服务器端把空闲连接给断开了。只能重新连接</ul><ol><li>如果使用的是 <code class="language-plaintext highlighter-rouge">iTerm2</code>，要让ssh空闲不断线： <code class="language-plaintext highlighter-rouge">profiles -&gt; sessions -&gt; When idel, send ASCII code 97 every 60s</code><ul><li>配置的ASCII code是97，所以是一串aaaaaa，一看效果，果然没断。<li>但是接着用了用，就发现有坑了……<li>开着vim，过了一段时间再回来时，这一长串aaaaaa……还要手工ESC，u一下，才恢复，而且指不定还会有其它副作用，实在蛋疼……</ul><li>通过客户端ssh参数配置<ul><li>其它命令行客户端，通过配置 ServerAliveInterval 来实现，在 <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> 中加入： <code class="language-plaintext highlighter-rouge">ServerAliveInterval=30</code>。<li><code class="language-plaintext highlighter-rouge">ServerAliveInterval=30</code>: 表示ssh客户端每隔30秒给远程主机发送一个<code class="language-plaintext highlighter-rouge">no-op</code>包, <code class="language-plaintext highlighter-rouge">no-op</code>是无任何操作的意思，这样远程主机就不会关闭这个SSH会话。</ul><ul><li>只需要在当前用户的ssh连接调整就好（注意：是本地发起连接的客户端！并非修改所要连接的远程服务器端)<li><code class="language-plaintext highlighter-rouge">vim ~/.ssh/config</code>，<li>然后新增<li><code class="language-plaintext highlighter-rouge">Host *     ServerAliveInterval 60</code> - 60秒就好了，而且基本去连的机器都保持，所以配置了* - 如果有需要针对某个机器，可以自行配置为需要的serverHostName。</ul><li>单次连接<ul><li>若只是单次连接时需要，可使用-o参数实现：<li><code class="language-plaintext highlighter-rouge">ssh -o ServerAliveInterval=30 user@host</code></ul></ol><hr /><h2 id="system-administration">system administration</h2><h3 id="test-if-ssh-is-running">test if ssh is running</h3><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">ps</span> <span class="n">aux</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">ssh</span>
<span class="n">root</span>      <span class="mi">3278</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">94892</span>  <span class="mi">6752</span> <span class="o">?</span>        <span class="n">Ss</span>   <span class="n">Apr11</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">sshd</span><span class="o">:</span> <span class="n">ubuntu</span> <span class="p">[</span><span class="n">priv</span><span class="p">]</span>
<span class="n">ubuntu</span>    <span class="mi">3341</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">94892</span>  <span class="mi">3968</span> <span class="o">?</span>        <span class="n">S</span>    <span class="n">Apr11</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">sshd</span><span class="o">:</span> <span class="n">ubuntu</span><span class="err">@</span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span>
<span class="n">ubuntu</span>    <span class="mi">5795</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">12940</span>  <span class="mi">1016</span> <span class="n">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="n">S</span><span class="o">+</span>   <span class="mo">00</span><span class="o">:</span><span class="mo">05</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span> <span class="n">ssh</span>
<span class="n">root</span>     <span class="mi">20273</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">65508</span>  <span class="mi">5944</span> <span class="o">?</span>        <span class="n">Ss</span>   <span class="n">Apr11</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sshd</span> <span class="o">-</span><span class="n">D</span>
</pre></table></code></div></div><hr /><h3 id="change-the-port">change the port</h3><p>port 22 open will have a lot of attacks</p><p>solutions:</p><ul><li>editing the port, so it doesn’t answer on port 22.<li>change to something else.</ul><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>
<span class="mi">1</span><span class="p">.</span> <span class="n">check</span> <span class="n">the</span> <span class="n">port</span> <span class="n">open</span> <span class="n">on</span> <span class="n">the</span> <span class="n">host</span>

<span class="c1">// malicious users</span>
<span class="err">$</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">T4</span> <span class="o">-</span><span class="n">F</span> <span class="mi">3</span><span class="p">.</span><span class="mi">22</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">152</span>
<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mi">7</span><span class="p">.</span><span class="mi">80</span> <span class="p">(</span> <span class="n">https</span><span class="o">:</span><span class="c1">//nmap.org ) at 2020-04-11 20:29 EDT</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">ec2</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">22</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mi">152</span><span class="p">.</span><span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="n">compute</span><span class="p">.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span> <span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">22</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">152</span><span class="p">)</span>
<span class="n">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mo">031</span><span class="n">s</span> <span class="n">latency</span><span class="p">).</span>
<span class="n">Not</span> <span class="n">shown</span><span class="o">:</span> <span class="mi">92</span> <span class="n">closed</span> <span class="n">ports</span>
<span class="n">PORT</span>     <span class="n">STATE</span>    <span class="n">SERVICE</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">open</span>     <span class="n">ssh</span>
<span class="mi">25</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">filtered</span> <span class="n">smtp</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">filtered</span> <span class="n">msrpc</span>
<span class="mi">139</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">filtered</span> <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">filtered</span> <span class="n">microsoft</span><span class="o">-</span><span class="n">ds</span>
<span class="mi">5900</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>     <span class="n">vnc</span>
<span class="mi">6000</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>     <span class="n">X11</span>
<span class="mi">6001</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>     <span class="n">X11</span><span class="o">:</span><span class="mi">1</span>
<span class="c1">// even the os</span>
<span class="n">sudo</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">O</span> <span class="mi">3</span><span class="p">.</span><span class="mi">22</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">152</span>
<span class="n">Aggressive</span> <span class="n">OS</span> <span class="n">guesses</span><span class="o">:</span> <span class="n">Linux</span> <span class="mi">3</span><span class="p">.</span><span class="mi">11</span> <span class="o">-</span> <span class="mi">4</span><span class="p">.</span><span class="mi">1</span> <span class="p">(</span><span class="mi">94</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">3</span><span class="p">.</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">.</span><span class="mi">8</span> <span class="p">(</span><span class="mi">94</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">32</span> <span class="p">(</span><span class="mi">93</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">39</span> <span class="p">(</span><span class="mi">92</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">3</span><span class="p">.</span><span class="mi">13</span> <span class="p">(</span><span class="mi">90</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">4</span><span class="p">.</span><span class="mi">4</span> <span class="p">(</span><span class="mi">90</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">32</span> <span class="n">or</span> <span class="mi">3</span><span class="p">.</span><span class="mi">10</span> <span class="p">(</span><span class="mi">89</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span> <span class="n">or</span> <span class="mi">3</span><span class="p">.</span><span class="mi">5</span> <span class="p">(</span><span class="mi">89</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">4</span><span class="p">.</span><span class="mi">2</span> <span class="p">(</span><span class="mi">89</span><span class="o">%</span><span class="p">),</span> <span class="n">Linux</span> <span class="mi">3</span><span class="p">.</span><span class="mi">8</span> <span class="p">(</span><span class="mi">89</span><span class="o">%</span><span class="p">)</span>
<span class="n">No</span> <span class="n">exact</span> <span class="n">OS</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">host</span> <span class="p">(</span><span class="n">test</span> <span class="n">conditions</span> <span class="n">non</span><span class="o">-</span><span class="n">ideal</span><span class="p">).</span>
<span class="n">Network</span> <span class="n">Distance</span><span class="o">:</span> <span class="mi">28</span> <span class="n">hops</span>

<span class="c1">// or kali</span>
<span class="n">zenmap</span><span class="o">:</span> <span class="n">target</span> <span class="n">ip</span>  
<span class="n">command</span><span class="o">:</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">T4</span> <span class="o">-</span><span class="n">F</span> <span class="mi">3</span><span class="p">.</span><span class="mi">22</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">152</span>
</pre></table></code></div></div><ol><li>change the file</ol><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
</pre><td class="rouge-code"><pre>
<span class="c1">// command line: change the ssh port to 2237</span>
<span class="err">$</span> <span class="n">semanage</span> <span class="n">port</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">t</span> <span class="n">ssh_port_t</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span><span class="p">,</span> <span class="n">then</span> <span class="n">the</span> <span class="mi">2237</span><span class="p">.</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">semanage</span> <span class="n">port</span> <span class="o">-</span><span class="n">l</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">ssh</span>
<span class="n">ssh_port_t</span>                     <span class="n">tcp</span>      <span class="mi">2237</span>

<span class="c1">// restart the ssh</span>
<span class="err">$</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">sshd</span><span class="p">.</span><span class="n">service</span>
<span class="o">====</span> <span class="n">AUTHENTICATING</span> <span class="n">FOR</span> <span class="n">org</span><span class="p">.</span><span class="n">freedesktop</span><span class="p">.</span><span class="n">systemd1</span><span class="p">.</span><span class="n">manage</span><span class="o">-</span><span class="n">units</span> <span class="o">===</span>
<span class="n">Authentication</span> <span class="n">is</span> <span class="n">required</span> <span class="n">to</span> <span class="n">restart</span> <span class="err">'</span><span class="n">ssh</span><span class="p">.</span><span class="n">service</span><span class="err">'</span><span class="p">.</span>
<span class="n">Multiple</span> <span class="n">identities</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="k">for</span> <span class="n">authentication</span><span class="o">:</span>
 <span class="mi">1</span><span class="p">.</span>  <span class="n">Ubuntu</span> <span class="p">(</span><span class="n">ubuntu</span><span class="p">)</span>
 <span class="mi">2</span><span class="p">.</span>  <span class="n">bob</span>
 <span class="mi">3</span><span class="p">.</span>  <span class="n">lisa</span>
<span class="n">Choose</span> <span class="n">identity</span> <span class="n">to</span> <span class="n">authenticate</span> <span class="n">as</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">:</span> <span class="mi">2</span>
<span class="n">Password</span><span class="o">:</span>
<span class="o">====</span> <span class="n">AUTHENTICATION</span> <span class="n">COMPLETE</span> <span class="o">===</span>

<span class="err">$</span> <span class="n">ps</span> <span class="n">aux</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">ssh</span>
<span class="n">root</span>      <span class="mi">3278</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">94892</span>  <span class="mi">6752</span> <span class="o">?</span>        <span class="n">Ss</span>   <span class="n">Apr11</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">sshd</span><span class="o">:</span> <span class="n">ubuntu</span> <span class="p">[</span><span class="n">priv</span><span class="p">]</span>
<span class="n">ubuntu</span>    <span class="mi">3341</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">94892</span>  <span class="mi">3968</span> <span class="o">?</span>        <span class="n">S</span>    <span class="n">Apr11</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">sshd</span><span class="o">:</span> <span class="n">ubuntu</span><span class="err">@</span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span>
<span class="n">root</span>      <span class="mi">8173</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">65508</span>  <span class="mi">5492</span> <span class="o">?</span>        <span class="n">Ss</span>   <span class="mo">00</span><span class="o">:</span><span class="mi">56</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sshd</span> <span class="o">-</span><span class="n">D</span>
<span class="n">bob</span>       <span class="mi">8179</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">12940</span>  <span class="mi">1032</span> <span class="n">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="n">S</span><span class="o">+</span>   <span class="mo">00</span><span class="o">:</span><span class="mi">57</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="k">auto</span> <span class="n">ssh</span>



<span class="c1">// edit the file</span>
<span class="err">$</span> <span class="n">vi</span>  <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span>

<span class="cp"># Package generated configuration file
# See the sshd_config(5) manpage for details
</span>
<span class="cp"># What ports, IPs and protocols we listen for
</span><span class="c1">// here!!!!!!!!!!!</span>
<span class="c1">// change to other port</span>
<span class="c1">// port 2237</span>
<span class="n">Port</span> <span class="mi">22</span>
<span class="cp"># Use these options to restrict which interfaces/protocols sshd will bind to
#ListenAddress ::
#ListenAddress 0.0.0.0
</span><span class="n">Protocol</span> <span class="mi">2</span>
<span class="cp"># HostKeys for protocol version 2
</span><span class="n">HostKey</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_host_rsa_key</span>
<span class="n">HostKey</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_host_dsa_key</span>
<span class="n">HostKey</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_host_ecdsa_key</span>
<span class="n">HostKey</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_host_ed25519_key</span>
<span class="cp">#Privilege Separation is turned on for security
</span><span class="n">UsePrivilegeSeparation</span> <span class="n">yes</span>

<span class="cp"># Lifetime and size of ephemeral version 1 server key
</span><span class="n">KeyRegenerationInterval</span> <span class="mi">3600</span>
<span class="n">ServerKeyBits</span> <span class="mi">1024</span>

<span class="cp"># Logging
</span><span class="n">SyslogFacility</span> <span class="n">AUTH</span>
<span class="n">LogLevel</span> <span class="n">INFO</span>

<span class="cp"># Authentication:
</span><span class="n">LoginGraceTime</span> <span class="mi">120</span>
<span class="n">PermitRootLogin</span> <span class="n">prohibit</span><span class="o">-</span><span class="n">password</span>
<span class="n">StrictModes</span> <span class="n">yes</span>

<span class="n">RSAAuthentication</span> <span class="n">yes</span>
<span class="n">PubkeyAuthentication</span> <span class="n">yes</span>
<span class="cp">#AuthorizedKeysFile	%h/.ssh/authorized_keys
</span>
<span class="cp"># Dont read the users ~/.rhosts and ~/.shosts files
</span><span class="n">IgnoreRhosts</span> <span class="n">yes</span>
<span class="cp"># For this to work you will also need host keys in /etc/ssh_known_hosts
</span><span class="n">RhostsRSAAuthentication</span> <span class="n">no</span>
<span class="cp"># similar for protocol version 2
</span><span class="n">HostbasedAuthentication</span> <span class="n">no</span>
<span class="cp"># Uncomment if you dont trust ~/.ssh/known_hosts for RhostsRSAAuthentication
#IgnoreUserKnownHosts yes
</span>
<span class="cp"># To enable empty passwords, change to yes (NOT RECOMMENDED)
</span><span class="n">PermitEmptyPasswords</span> <span class="n">no</span>

<span class="cp"># Change to yes to enable challenge-response passwords (beware issues with some PAM modules and threads)
</span><span class="n">ChallengeResponseAuthentication</span> <span class="n">no</span>

<span class="cp"># Change to no to disable tunnelled clear text passwords
</span><span class="n">PasswordAuthentication</span> <span class="n">yes</span>

<span class="cp"># Kerberos options
#KerberosAuthentication no
#KerberosGetAFSToken no
#KerberosOrLocalPasswd yes
#KerberosTicketCleanup yes
</span>
<span class="cp"># GSSAPI options
#GSSAPIAuthentication no
#GSSAPICleanupCredentials yes
</span>
<span class="n">X11Forwarding</span> <span class="n">yes</span>
<span class="n">X11DisplayOffset</span> <span class="mi">10</span>
<span class="n">PrintMotd</span> <span class="n">no</span>
<span class="n">PrintLastLog</span> <span class="n">yes</span>
<span class="n">TCPKeepAlive</span> <span class="n">yes</span>
<span class="cp">#UseLogin no
</span>
<span class="cp">#MaxStartups 10:30:60
#Banner /etc/issue.net
</span>
<span class="cp"># Allow client to pass locale environment variables
</span><span class="n">AcceptEnv</span> <span class="n">LANG</span> <span class="n">LC_</span><span class="o">*</span>

<span class="n">Subsystem</span> <span class="n">sftp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">openssh</span><span class="o">/</span><span class="n">sftp</span><span class="o">-</span><span class="n">server</span>

<span class="cp"># Set this to 'yes' to enable PAM authentication, account processing,
# and session processing. If this is enabled, PAM authentication will
# be allowed through the ChallengeResponseAuthentication and
# PasswordAuthentication.  Depending on your PAM configuration,
# PAM authentication via ChallengeResponseAuthentication may bypass
# the setting of "PermitRootLogin without-password".
# If you just want the PAM account and session checks to run without
# PAM authentication, then enable this but set PasswordAuthentication
# and ChallengeResponseAuthentication to 'no'.
</span><span class="n">UsePAM</span> <span class="n">yes</span>



</pre></table></code></div></div><hr /><h2 id="ssh基本用法">SSH基本用法</h2><h3 id="changing-and-exploring-directories">Changing and Exploring Directories</h3><p>SSH terminal can predict what you’re going to type by pressing tab.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">example</span>

<span class="n">to</span> <span class="n">go</span> <span class="n">to</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">vhosts</span><span class="o">/</span><span class="n">domainname</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">httpdocs</span>

<span class="o">/</span><span class="n">v</span><span class="err">`</span><span class="n">TAB</span><span class="err">`</span><span class="n">w</span><span class="err">`</span><span class="n">TAB</span><span class="err">`</span><span class="n">v</span><span class="err">`</span><span class="n">TAB</span><span class="err">`</span><span class="n">d</span><span class="err">`</span><span class="n">TAB</span><span class="err">`</span><span class="n">h</span><span class="err">`</span><span class="n">TAB</span><span class="err">`</span><span class="n">d</span><span class="err">`</span><span class="n">TAB</span><span class="err">`</span>

<span class="n">This</span> <span class="n">displays</span> <span class="n">as</span>

<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">vhosts</span><span class="o">/</span><span class="n">domainname</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">httpdocs</span><span class="o">/</span>

<span class="n">There</span> <span class="n">were</span> <span class="n">two</span> <span class="n">folders</span> <span class="n">the</span> <span class="n">with</span> <span class="n">similar</span> <span class="n">names</span><span class="p">.</span>

<span class="cp"># httpdocs (the one I was after)
# httpsdocs (very similar but with an s in there)
</span>
<span class="n">As</span> <span class="n">a</span> <span class="n">result</span> <span class="n">the</span> <span class="n">Tab</span> <span class="n">key</span> <span class="n">autofilled</span> <span class="err">‘</span><span class="n">http</span><span class="err">’</span> <span class="n">but</span> <span class="n">didn</span><span class="err">’</span><span class="n">t</span> <span class="n">know</span> <span class="n">which</span> <span class="n">of</span> <span class="n">the</span> <span class="n">two</span> <span class="n">directories</span> <span class="n">I</span> <span class="n">was</span> <span class="n">autofilling</span><span class="p">.</span> <span class="n">Pressing</span> <span class="n">d</span> <span class="n">then</span> <span class="n">Tab</span> <span class="n">again</span> <span class="n">confirmed</span> <span class="n">that</span> <span class="n">I</span> <span class="n">wanted</span> <span class="n">httpdocs</span> <span class="n">and</span> <span class="n">not</span> <span class="n">httpsdocs</span> <span class="n">which</span> <span class="n">would</span> <span class="n">have</span> <span class="n">required</span> <span class="n">the</span> <span class="n">letter</span> <span class="err">‘</span><span class="n">s</span><span class="err">’</span> <span class="n">instead</span> <span class="n">as</span> <span class="n">that</span><span class="err">’</span><span class="n">s</span> <span class="n">the</span> <span class="n">first</span> <span class="n">letter</span> <span class="n">after</span> <span class="n">the</span> <span class="n">autofilled</span> <span class="n">item</span><span class="p">.</span>
</pre></table></code></div></div><h3 id="ssh远程登录">SSH远程登录</h3><p>sshkey.private Login $ <code class="language-plaintext highlighter-rouge">ssh</code> <code class="language-plaintext highlighter-rouge">-i</code> <code class="language-plaintext highlighter-rouge">./sshkey.private</code> <code class="language-plaintext highlighter-rouge">username@localhost</code></p><h4 id="1-口令登录">1. 口令登录</h4><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="c1"># 以用户名user，登录远程主机host
</span><span class="err">$</span> <span class="n">ssh</span> <span class="n">username</span><span class="o">@</span><span class="n">hostname</span>   <span class="c1">#ssh pika@192.168.0.111
</span>
<span class="c1"># 如果本地用户名与远程用户名一致，登录时可以省略用户名。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="n">hostname</span>

<span class="c1"># 你的登录请求会送进远程主机的SSH默认端口22。用-p 修改端口。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">p</span> <span class="mi">2222</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span>   <span class="c1"># ssh直接连接远程主机的2222端口
</span>
<span class="c1"># 第一次登录对方主机，系统会出现下面的提示
</span><span class="err">$</span> <span class="n">ssh</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span>
<span class="n">The</span> <span class="n">authenticity</span> <span class="n">of</span> <span class="n">host</span> <span class="s">'host (12.18.429.21)'</span> <span class="n">can</span><span class="s">'t be established.
RSA key fingerprint is 98:2e:d7:e0:de:9f:ac:67:28:c2:42:2d:37:16:58:4d.
Are you sure you want to continue connecting (yes/no)?
# 无法确认host主机的真实性，只知道它的公钥指纹，继续连接？
# 公钥指纹 RSA key fingerprint:
# 指公钥长度较长（采用RSA算法，长达1024位），很难比对，
# 所以对其进行MD5计算变成一个128位的指纹。再进行比较就容易多了。
# 上例中是98:2e:d7:e0:de:9f:ac:67:28:c2:42:2d:37:16:58:4d，

# 问题是，用户怎么知道远程主机的公钥指纹应该是多少？
# 没有好办法，远程主机必须在自己的网站上贴出公钥指纹，以便用户自行核对。

- 假定经过风险衡量以后，用户决定接受这个远程主机的公钥。
    　　Are you sure you want to continue connecting (yes/no)? yes
- 系统会出现一句提示，表示host主机已经得到认可。
    　　Warning: Permanently added '</span><span class="n">host</span><span class="p">,</span><span class="mf">12.18</span><span class="p">.</span><span class="mf">429.21</span><span class="s">' (RSA) to the list of known hosts.
- 然后，会要求输入密码。
    　　Password: (enter password)
- 如果密码正确，就可以登录了。
- 当远程主机的公钥被接受以后，它就会被保存在文件 $HOME/.ssh/known_hosts 之中。下次再连接这台主机，系统就会认出它的公钥已经保存在本地了，从而跳过警告部分，直接提示输入密码。
- 每个SSH用户都有自己的known_hosts文件，此外系统也有一个这样的文件，通常是 /etc/ssh/ssh_known_hosts ，保存一些对所有用户都可信赖的远程主机的公钥。

# check you user
$ whoami  
ubuntu


</span></pre></table></code></div></div><hr /><h4 id="2-公钥登录-ssh-copy-id-userhost">2. 公钥登录 <code class="language-plaintext highlighter-rouge">ssh-copy-id user@host</code></h4><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="o">-</span> <span class="n">使用密码登录</span><span class="err">，</span><span class="n">每次都必须输入密码</span><span class="err">，</span><span class="n">非常麻烦</span><span class="err">。</span>
<span class="o">-</span> <span class="n">好在SSH还提供了公钥登录</span><span class="err">，</span><span class="n">省去输入密码的步骤</span><span class="err">。</span>
<span class="o">-</span> <span class="n">公钥登录</span><span class="p">:</span> <span class="n">用户将自己的公钥储存在远程主机上</span><span class="err">。</span><span class="n">登录时</span><span class="err">，</span><span class="n">远程主机向用户发送一段随机字符串</span><span class="err">，</span><span class="n">用户用自己的私钥加密后</span><span class="err">，</span><span class="n">再发回来</span><span class="err">。</span><span class="n">远程主机用事先储存的公钥进行解密</span><span class="err">，</span><span class="n">如果成功证明用户可信</span><span class="err">，</span><span class="n">直接允许登录shell</span><span class="err">，</span><span class="n">不再要求密码</span><span class="err">。</span>

<span class="o">-</span> <span class="n">寻找主机密钥</span>
  <span class="o">-</span> <span class="n">在准备添加密钥之前不妨先用以下命令看看是否已经添加了对应主机的密钥了</span><span class="p">.</span>

<span class="err">$</span> <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">F</span> <span class="mf">10.42</span><span class="p">.</span><span class="mf">0.47</span>
<span class="n">Host</span> <span class="mf">10.42</span><span class="p">.</span><span class="mf">0.47</span> <span class="n">found</span><span class="p">:</span> <span class="n">line</span> <span class="mi">1</span> <span class="nb">type</span> <span class="n">ECDSA</span>
<span class="p">.............</span>

<span class="o">-</span> <span class="n">这种方法要求用户必须提供自己的</span> <span class="n">公钥</span> <span class="err">。</span>
<span class="o">-</span> <span class="n">没有现成可以直接用</span> <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="n">生成一个</span><span class="err">：</span>
<span class="err">$</span> <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span>

<span class="err">$</span> <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">dsa</span>
<span class="n">generating</span> <span class="n">public</span><span class="o">/</span><span class="n">private</span> <span class="n">dsa</span> <span class="n">key</span> <span class="n">pair</span><span class="p">.</span>
<span class="n">enter</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">to</span> <span class="n">save</span> <span class="n">the</span> <span class="n">key</span> <span class="p">(</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">.....</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_dsa</span><span class="p">):</span>
<span class="n">enter</span> <span class="n">passphrase</span> <span class="p">(</span><span class="n">empty</span> <span class="k">for</span> <span class="n">no</span> <span class="n">passphrase</span><span class="p">):</span>
<span class="n">enter</span> <span class="n">same</span> <span class="n">passphrase</span> <span class="n">again</span><span class="p">:</span>
<span class="n">your</span> <span class="n">identification</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">.....</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_dsa</span><span class="p">.</span>
<span class="n">your</span> <span class="n">public</span> <span class="n">key</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="ow">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">.....</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_dsa</span><span class="p">.</span><span class="n">pub</span><span class="p">.</span>
<span class="n">the</span> <span class="n">key</span> <span class="n">fingerprint</span> <span class="ow">is</span><span class="p">:</span>
<span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="n">f5</span><span class="p">:...............:</span><span class="n">fd</span> <span class="n">XXX</span><span class="o">@</span><span class="n">grave</span>
<span class="n">the</span> <span class="n">key</span><span class="s">'s randomart image is:
.....

- 运行上面的命令以后，系统会出现一系列提示，可以一路回车。
- 其中有一个问题是，要不要对私钥设置口令（passphrase），如果担心私钥的安全，这里可以设置一个。
- 运行结束以后，在$HOME/.ssh/目录下，会新生成两个文件：
- id_rsa.pub 公钥 和 id_rsa 私钥。

- 这时再输入下面的命令，将公钥传送到远程主机host上面：
    　　$ ssh-copy-id user@host
- 好了，从此再登录就不需要输入密码了。

- 如果还是不行，就打开远程主机的 /etc/ssh/sshd_config 这个文件，检查下面几行前面"#"注释是否取掉。
    　　RSAAuthentication yes
    　　PubkeyAuthentication yes
    　　AuthorizedKeysFile .ssh/authorized_keys
- 然后，重启远程主机的ssh服务。
    　　// ubuntu系统
    　　service ssh restart
    　　// debian系统
    　　/etc/init.d/ssh restart


- 删除主机密钥
  - 某些情况下, 如主机地址更改或者不再使用某个密钥, 需要删除某个密钥.
$ ssh-keygen -R 10.42.0.47
# 比手动在 ~/.ssh/known_hosts 文件中删除要方便很多.


</span></pre></table></code></div></div><h4 id="3-authorized_keys文件">3. authorized_keys文件</h4><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="o">-</span> <span class="n">远程主机将用户的公钥</span><span class="err">，</span><span class="n">保存在登录后的用户主目录的</span> <span class="err">$</span><span class="n">HOME</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">authorized_keys</span> <span class="n">文件中</span><span class="err">。</span><span class="n">公钥就是一段字符串</span><span class="err">，</span><span class="n">只要把它追加在authorized_keys文件的末尾就行了</span><span class="err">。</span>
<span class="o">-</span> <span class="n">这里不使用上面的ssh</span><span class="o">-</span><span class="n">copy</span><span class="o">-</span><span class="n">id命令</span><span class="err">，</span><span class="n">改用下面的命令</span><span class="err">，</span><span class="n">解释公钥的保存过程</span><span class="err">：</span>
<span class="err">   </span> <span class="err">　　$</span> <span class="n">ssh</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span> <span class="s">'mkdir -p .ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys'</span> <span class="o">&lt;</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span>
<span class="o">-</span> <span class="n">分解开来看</span><span class="err">：</span>
  <span class="mf">1.</span> <span class="s">"$ ssh user@host"</span> <span class="p">:</span> <span class="n">登录远程主机</span><span class="err">；</span>
  <span class="mf">2.</span> <span class="s">'mkdir .ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys'</span><span class="p">:</span> <span class="n">表示登录后在远程shell上执行的命令</span>
    <span class="o">-</span> <span class="s">'$ mkdir -p .ssh'</span> <span class="n">的作用是</span><span class="err">，</span><span class="n">如果用户主目录中的</span><span class="p">.</span><span class="n">ssh目录不存在</span><span class="err">，</span><span class="n">就创建一个</span><span class="err">；</span>
    <span class="o">-</span> <span class="s">'cat &gt;&gt; .ssh/authorized_keys'</span> <span class="o">&lt;</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span> <span class="p">:</span> <span class="n">将本地的公钥文件</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span><span class="err">，</span><span class="n">重定向追加到远程文件authorized_keys的末尾</span><span class="err">。</span>
<span class="o">-</span> <span class="n">写入authorized_keys文件后</span><span class="err">，</span><span class="n">公钥登录的设置就完成了</span><span class="err">。</span>
</pre></table></code></div></div><h3 id="ssh远程操作">SSH远程操作</h3><h4 id="远程执行命令">远程执行命令</h4><p>有时在远程主机执行一条命令并显示到本地, 然后继续本地工作是很方便的. SSH 就能满足这个需求:</p><p>$ <code class="language-plaintext highlighter-rouge">ssh username@host</code> <code class="language-plaintext highlighter-rouge">command for host PC</code></p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">ssh</span> <span class="n">pi</span><span class="o">@</span><span class="mf">10.42</span><span class="p">.</span><span class="mf">0.47</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span>
<span class="c1"># 枚举远程主机的主目录内容并在本地显示.
</span>
<span class="err">$</span> <span class="n">ssh</span> <span class="n">pi</span><span class="o">@</span><span class="mf">10.42</span><span class="p">.</span><span class="mf">0.47</span> <span class="n">date</span>
<span class="n">pi</span><span class="o">@</span><span class="mf">10.42</span><span class="p">.</span><span class="mf">0.47</span><span class="s">'s password:
Thu Aug 7 22:33:51 EAT 2014
</span></pre></table></code></div></div><h4 id="ssh数据传输">SSH数据传输</h4><ul><li>SSH不仅可以用于远程主机登录，还可直接在远程主机上执行操作。</ul><p><code class="language-plaintext highlighter-rouge">$ ssh user@host 'mkdir -p .ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys' &lt; ~/.ssh/id_rsa.pub</code></p><ul><li>单引号, 在远程主机上执行的操作；<code class="language-plaintext highlighter-rouge">'mkdir -p .ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys'</code><li>后面的输入重定向，表示数据通过SSH传向远程主机。<code class="language-plaintext highlighter-rouge">&lt;</code> ~/.ssh/id_rsa.pub<li>分解开来看：<ol><li><code class="language-plaintext highlighter-rouge">$ ssh user@host</code> : 登录远程主机；<li><code class="language-plaintext highlighter-rouge">'mkdir -p .ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys'</code>: 表示登录后在远程shell上执行的命令<ul><li><code class="language-plaintext highlighter-rouge">'$ mkdir -p .ssh'</code>: 如果用户主目录中的.ssh目录不存在，就创建一个；<li><code class="language-plaintext highlighter-rouge">'cat &gt;&gt; .ssh/authorized_keys' &lt; ~/.ssh/id_rsa.pub</code> : 将本地的公钥文件 <code class="language-plaintext highlighter-rouge">~/.ssh/id_rsa.pub</code>，重定向追加到远程文件<code class="language-plaintext highlighter-rouge">authorized_keys</code>的末尾。</ul></ol><li>这就是说，SSH可以在用户和远程主机之间，建立命令和数据的传输通道，很多事情都可以通过SSH来完成。</ul><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1"># 将 $HOME/src/ 目录下面的所有文件，复制到远程主机的 $HOME/src/ 目录。
</span><span class="err">$</span> <span class="n">cd</span> <span class="o">&amp;&amp;</span> <span class="n">tar</span> <span class="n">czv</span> <span class="n">src</span> <span class="o">|</span> <span class="n">ssh</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span> <span class="s">'tar xz'</span>

<span class="c1"># 将远程主机 $HOME/src/ 目录下面的所有文件，复制到用户的当前目录。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span> <span class="s">'tar cz src'</span> <span class="o">|</span> <span class="n">tar</span> <span class="n">xzv</span>

<span class="c1"># 查看远程主机是否运行进程httpd。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span> <span class="s">'ps ax | grep [h]ttpd'</span>

<span class="c1"># 建议使用scp进行远程copy：
</span></pre></table></code></div></div><hr /><h2 id="copying-files">Copying Files</h2><h3 id="cp-copy"><code class="language-plaintext highlighter-rouge">cp</code> <code class="language-plaintext highlighter-rouge">copy</code></h3><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>
<span class="o">-</span><span class="n">a</span><span class="p">:</span> <span class="n">copy</span> <span class="n">the</span> <span class="nb">file</span> <span class="ow">or</span> <span class="n">directory</span> <span class="n">across</span> <span class="n">retaining</span> <span class="n">the</span> <span class="n">permissions</span> <span class="n">whilst</span> <span class="n">retaining</span> <span class="n">the</span> <span class="n">permissions</span> <span class="ow">and</span> <span class="n">ownership</span><span class="p">:</span>

    <span class="n">cp</span> <span class="o">-</span><span class="n">a</span> <span class="n">contactus</span><span class="p">.</span><span class="n">php</span> <span class="p">..</span><span class="o">/</span><span class="n">contact</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">php</span>


</pre></table></code></div></div><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>
<span class="n">copy</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="nb">dir</span><span class="p">:</span>

    <span class="n">cp</span> <span class="n">filename</span><span class="p">.</span><span class="n">txt</span> <span class="n">new</span><span class="o">-</span><span class="nb">file</span><span class="o">-</span><span class="n">name</span><span class="p">.</span><span class="n">txt</span>

<span class="n">copy</span> <span class="n">between</span> <span class="n">directories</span>

    <span class="n">cp</span> <span class="n">filename</span><span class="p">.</span><span class="n">txt</span> <span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">new</span><span class="o">-</span><span class="n">directory</span><span class="o">/</span><span class="n">filename</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">copy</span><span class="p">.</span><span class="n">txt</span>


<span class="n">copy</span> <span class="nb">all</span> <span class="n">files</span> <span class="k">from</span> <span class="n">one</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">another</span><span class="p">,</span> <span class="n">use</span> <span class="o">*</span><span class="p">:</span>

    <span class="n">cp</span> <span class="n">images</span><span class="o">/*</span> <span class="p">..</span><span class="o">/</span><span class="n">skin</span><span class="o">/</span>

</pre></table></code></div></div><h3 id="scp-跨机远程拷贝"><code class="language-plaintext highlighter-rouge">scp</code> 跨机远程拷贝</h3><ul><li><code class="language-plaintext highlighter-rouge">scp</code>是secure copy的简写，用于Linux下远程拷贝文件，类似的命令有<code class="language-plaintext highlighter-rouge">cp</code><li>不过<code class="language-plaintext highlighter-rouge">cp</code>只是在本机进行拷贝不能跨服务器，而且<code class="language-plaintext highlighter-rouge">scp</code>传输是加密的。会稍微影响一下速度。<li>两台主机之间复制文件必需得同时有两台主机的 复制执行帐号 和 操作权限 。</ul><p>can transfer and zip the file in the same time.</p><p>基础语法: $ <code class="language-plaintext highlighter-rouge">scp</code> <code class="language-plaintext highlighter-rouge">source_file_path</code> <code class="language-plaintext highlighter-rouge">destination_file_path</code></p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
</pre><td class="rouge-code"><pre><span class="n">scp命令参数</span>
<span class="o">-</span><span class="mi">1</span> <span class="n">强制scp命令使用协议ssh1</span>
<span class="o">-</span><span class="mi">2</span> <span class="n">强制scp命令使用协议ssh2</span>
<span class="o">-</span><span class="mi">4</span> <span class="n">强制scp命令只使用IPv4寻址</span>
<span class="o">-</span><span class="mi">6</span> <span class="n">强制scp命令只使用IPv6寻址</span>
<span class="o">-</span><span class="n">B</span> <span class="n">使用批处理模式</span><span class="err">（</span><span class="n">传输过程中不询问传输口令或短语</span><span class="err">）</span>
<span class="o">-</span><span class="n">C</span> <span class="n">允许压缩</span><span class="err">。（</span><span class="n">将</span><span class="o">-</span><span class="n">C标志传递给ssh</span><span class="err">，</span><span class="n">从而打开压缩功能</span><span class="err">）</span>
<span class="o">-</span><span class="n">p</span> <span class="n">留原文件的修改时间</span><span class="err">，</span><span class="n">访问时间和访问权限</span><span class="err">。</span>
<span class="o">-</span><span class="n">q</span> <span class="n">不显示传输进度条</span><span class="err">。</span>
<span class="o">-</span><span class="n">r</span> <span class="n">递归复制整个目录</span><span class="err">。</span> <span class="err">!!!!!!!!!!!</span>
<span class="o">-</span><span class="n">v</span> <span class="n">详细方式显示输出</span><span class="err">。</span><span class="n">scp和ssh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="n">会显示出整个过程的调试信息</span><span class="err">。</span><span class="n">这些信息用于调试连接</span><span class="err">，</span><span class="n">验证和配置问题</span><span class="err">。</span>
<span class="o">-</span><span class="n">c</span> <span class="n">cipher</span> <span class="n">以cipher将数据传输进行加密</span><span class="err">，</span><span class="n">这个选项将直接传递给ssh</span><span class="err">。</span>
<span class="o">-</span><span class="n">F</span> <span class="n">ssh_config</span> <span class="n">指定一个替代的ssh配置文件</span><span class="err">，</span><span class="n">此参数直接传递给ssh</span><span class="err">。</span>
<span class="o">-</span><span class="n">i</span> <span class="n">identity_file</span> <span class="p">:</span> <span class="n">从指定文件中读取传输时使用的密钥文件</span><span class="err">，</span><span class="n">此参数直接传递给ssh</span><span class="err">。</span>
<span class="o">-</span><span class="n">l</span> <span class="n">limit</span> <span class="n">限定用户所能使用的带宽</span><span class="err">，</span><span class="n">以Kbit</span><span class="o">/</span><span class="n">s为单位</span><span class="err">。</span>
<span class="o">-</span><span class="n">o</span> <span class="n">ssh_option</span> <span class="n">如果习惯于使用ssh_config</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="n">中的参数传递方式</span><span class="err">，</span>
<span class="o">-</span><span class="n">P</span> <span class="n">port</span> <span class="n">注意是大写的P</span><span class="p">,</span> <span class="n">port是指定数据传输用到的端口号</span>
<span class="o">-</span><span class="n">S</span> <span class="n">program</span> <span class="n">指定加密传输时所使用的程序</span><span class="err">。</span><span class="n">此程序必须能够理解ssh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="n">的选项</span><span class="err">。</span>
<span class="o">------------------------------------------------------------------------</span>

<span class="c1"># 本地复制远程文件
</span><span class="err">$</span> <span class="n">scp</span> <span class="n">root</span><span class="o">@</span><span class="n">www</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">com</span><span class="p">:</span><span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="c1"># 本地复制远程文件到指定目录：（把远程的文件复制到本地）
</span><span class="err">$</span> <span class="n">scp</span> <span class="n">root</span><span class="o">@</span><span class="n">www</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">com</span><span class="p">:</span><span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="o">/</span>
<span class="c1"># 远程复制本地文件
</span><span class="err">$</span> <span class="n">scp</span> <span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="n">root</span><span class="o">@</span><span class="n">www</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">com</span><span class="p">:</span><span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="c1"># 远程复制本地文件到指定目录
</span><span class="err">$</span> <span class="n">scp</span> <span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="n">root</span><span class="o">@</span><span class="n">www</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">com</span><span class="p">:</span><span class="o">/</span><span class="n">val</span><span class="o">/</span>

<span class="n">ps</span><span class="p">:</span> <span class="n">scp复制文件时只指定服务器地址不加路径默认复制到哪里</span><span class="err">???</span>

<span class="c1"># 在两个远程主机之间复制文件, 从一个远程主机复制到另一个远程主机。
</span><span class="err">$</span> <span class="n">scp</span> <span class="n">user1</span><span class="o">@</span><span class="n">host1</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">remote</span><span class="o">/</span><span class="nb">dir</span><span class="o">/</span><span class="n">foobar</span><span class="p">.</span><span class="n">txt</span> <span class="n">user2</span><span class="o">@</span><span class="n">host2</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">remote</span><span class="o">/</span><span class="nb">dir</span><span class="o">/</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">C</span> <span class="n">允许压缩</span><span class="err">。</span>
    <span class="o">-</span> <span class="n">用压缩来加快传输</span><span class="p">,</span> <span class="n">节省时间和带宽</span><span class="err">！</span>
    <span class="o">-</span> <span class="n">用C选项来启用压缩功能</span><span class="err">。</span><span class="n">文件在传输过程中被压缩</span><span class="err">，</span><span class="n">在目的主机上被解压缩</span><span class="err">。</span>

<span class="c1"># 开启压缩选项移动了整个文件夹。速度的增长取决于多少文件能被压缩。
</span><span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">vrC</span> <span class="o">~/</span><span class="n">Downloads</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Downloads</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">c</span> <span class="n">cipher</span> <span class="n">以cipher将数据传输进行加密</span><span class="err">，</span><span class="n">这个选项将直接传递给ssh</span><span class="err">。</span>
  <span class="o">-</span> <span class="n">scp默认使用AES加密</span>
  <span class="o">-</span> <span class="n">用不同的加密可能会加快转移过程</span><span class="err">，</span><span class="n">举例</span><span class="p">:</span><span class="n">blowfish和arcfour比AES更快</span><span class="err">（</span><span class="n">但是安全不如AES</span><span class="err">）</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">c</span> <span class="n">blowfish</span> <span class="o">-</span><span class="n">C</span> <span class="o">~/</span><span class="n">local_file</span><span class="p">.</span><span class="n">txt</span> <span class="n">username</span><span class="o">@</span><span class="n">remotehost</span><span class="p">:</span><span class="o">/</span><span class="n">remote</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="nb">file</span><span class="p">.</span><span class="n">txt</span>
<span class="c1"># 用blowfish加密并同时压缩
# 可以得到显著的速度上的提升，当然也取决于可用的带宽。
</span>
<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">i</span> <span class="n">identity_file</span> <span class="n">特殊标识文件</span>
  <span class="o">-</span> <span class="n">从指定文件中读取传输时使用的密钥文件</span><span class="err">，</span><span class="n">此参数直接传递给ssh</span><span class="err">。</span>
  <span class="o">-</span> <span class="n">当使用基于</span> <span class="n">秘钥认证</span><span class="err">（</span><span class="n">无密码</span><span class="err">）。</span><span class="n">你将使用特殊的包含私有秘钥的标识文件</span><span class="err">。</span>
  <span class="o">-</span> <span class="n">这个选项直接传递到ssh命令并且以同样的方式工作</span><span class="err">。</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">vCq</span> <span class="o">-</span><span class="n">i</span> <span class="n">private_key</span><span class="p">.</span><span class="n">pem</span> <span class="o">~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">l</span> <span class="n">limit</span> <span class="n">限定用户所能使用的带宽</span>
    <span class="o">-</span> <span class="n">限制带宽的使用</span><span class="p">,</span> <span class="n">不想scp占用所有的带宽</span>
    <span class="o">-</span> <span class="n">用选项</span><span class="err">“</span><span class="n">l</span><span class="err">”</span><span class="n">来限制最大传输速度</span><span class="err">，</span><span class="n">以Kbit</span><span class="o">/</span><span class="n">s为单位</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">vrC</span> <span class="o">-</span><span class="n">l</span> <span class="mi">400</span> <span class="o">~/</span><span class="n">Downloads</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Downloads</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">P</span> <span class="n">port</span> <span class="n">在远程主机上连接一个不同的端口</span>
  <span class="o">-</span> <span class="n">大写的P</span><span class="p">,</span> <span class="n">port是指定数据传输用到的端口号</span>
  <span class="o">-</span> <span class="n">如果</span> <span class="n">远程服务器</span> <span class="n">有ssh守护进程运行在不同的端口上</span><span class="err">（</span><span class="n">默认是22</span><span class="err">），</span><span class="n">那么需要使用</span><span class="err">“</span><span class="o">-</span><span class="n">P</span><span class="err">”</span><span class="n">选项来使用指定的端口</span><span class="err">。</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">vC</span> <span class="o">-</span><span class="n">P</span> <span class="mi">2200</span> <span class="o">~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">p</span> <span class="n">小写</span> <span class="n">保存文件属性</span>
  <span class="o">-</span> <span class="n">保存源文件的修改时间</span><span class="err">，</span><span class="n">访问时间以及方式</span><span class="err">。</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">C</span> <span class="o">-</span><span class="n">p</span> <span class="o">~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">q</span> <span class="n">安静模式</span> <span class="n">不显示传输进度条</span>
  <span class="o">-</span> <span class="n">scp输出将会减少</span>
  <span class="o">-</span> <span class="n">不再显示进度表以及警告和诊断信息</span><span class="err">。</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">vCq</span> <span class="o">~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">F</span> <span class="n">ssh_config</span> <span class="n">使用不同的ssh_config文件</span>
  <span class="o">-</span> <span class="n">指定一个替代的ssh配置文件</span><span class="err">，</span><span class="n">此参数直接传递给ssh</span><span class="err">。</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">vC</span> <span class="o">-</span><span class="n">F</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">my_ssh_config</span> <span class="o">~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="o">------------------------------------------------------------------------</span>

<span class="o">-</span><span class="n">r</span> <span class="n">递归复制整个目录</span>

<span class="c1"># -r: 把远程的目录 复制到 本地   
</span><span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="n">root</span><span class="o">@</span><span class="n">www</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">com</span><span class="p">:</span><span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="o">/</span> <span class="o">/</span><span class="n">val</span><span class="o">/</span><span class="n">test</span><span class="o">/</span>
<span class="c1"># -r: 把本地的目录 复制到 远程主机上
</span><span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="p">.</span><span class="o">/</span><span class="n">ubuntu_env</span><span class="o">/</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">0.111</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pipi</span>
<span class="n">pika</span><span class="p">:</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">pika</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">machine_learning</span><span class="o">/</span><span class="n">datasets</span>
<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="n">SocialNetworks</span><span class="o">/</span> <span class="n">piting</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">0.172</span><span class="p">:</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">pipi</span><span class="o">/</span><span class="n">datasets</span>

<span class="c1"># 从一个主机往另一个主机复制整个文件夹，需要使用r switch并且指定目录
</span><span class="mi">1</span> <span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">r</span> <span class="o">~/</span><span class="n">Downloads</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Downloads</span>
<span class="o">------------------------------------------------------------------------</span>
<span class="n">详细方式显示输出</span>
<span class="o">-</span><span class="n">v</span> <span class="n">scp和ssh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="n">会显示出整个过程的调试信息</span><span class="err">。</span><span class="n">这些信息用于调试连接</span><span class="err">，</span><span class="n">验证和配置问题</span><span class="err">。</span>
  <span class="o">-</span> <span class="n">SCP的程序将输出大量关于它在后台做什么的信息</span><span class="err">。</span>
  <span class="o">-</span> <span class="n">当程序失败或无法完成请求时</span><span class="err">。</span><span class="n">详细的输出将正确的指明该程序哪里出了问题</span><span class="err">。</span>

<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">v</span>  <span class="o">~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>  <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">help2356</span><span class="p">.</span><span class="n">txt</span>

    <span class="n">Executing</span><span class="p">:</span> <span class="n">program</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ssh</span> <span class="n">host</span> <span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">user</span> <span class="n">root</span><span class="p">,</span> <span class="n">command</span> <span class="n">scp</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">t</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">help2356</span><span class="p">.</span><span class="n">txt</span>
    <span class="n">OpenSSH_6</span><span class="p">.</span><span class="mi">2</span><span class="n">p2</span> <span class="n">Ubuntu</span><span class="o">-</span><span class="mi">6</span><span class="n">ubuntu0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">OpenSSL</span> <span class="mf">1.0</span><span class="p">.</span><span class="mi">1</span><span class="n">e</span> <span class="mi">11</span> <span class="n">Feb</span> <span class="mi">2013</span>
    <span class="n">debug1</span><span class="p">:</span> <span class="n">Reading</span> <span class="n">configuration</span> <span class="n">data</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">enlightened</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">config</span>
    <span class="n">debug1</span><span class="p">:</span> <span class="n">Reading</span> <span class="n">configuration</span> <span class="n">data</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_config</span>
    <span class="n">debug1</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_config</span> <span class="n">line</span> <span class="mi">19</span><span class="p">:</span> <span class="n">Applying</span> <span class="n">options</span> <span class="k">for</span> <span class="o">*</span>
    <span class="n">debug1</span><span class="p">:</span> <span class="n">Connecting</span> <span class="n">to</span> <span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span> <span class="p">[</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">]</span> <span class="n">port</span> <span class="mf">22.</span>
    <span class="n">debug1</span><span class="p">:</span> <span class="n">Connection</span> <span class="n">established</span><span class="p">.</span>
    <span class="p">.....</span> <span class="n">OUTPUT</span> <span class="n">TRUNCATED</span>
<span class="o">------------------------------------------------------------------------</span>
<span class="n">多文件传输</span>
<span class="c1"># 多个文件可以像下面那样用空格分隔开
</span><span class="err">$</span> <span class="n">scp</span> <span class="n">foo</span><span class="p">.</span><span class="n">txt</span> <span class="n">bar</span><span class="p">.</span><span class="n">txt</span> <span class="n">username</span><span class="o">@</span><span class="n">remotehost</span><span class="p">:</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">directory</span><span class="o">/</span>

<span class="c1"># 从远程主机复制多个文件到当前目录
</span><span class="err">$</span> <span class="n">scp</span> <span class="n">username</span><span class="o">@</span><span class="n">host</span><span class="p">:</span><span class="n">path</span>\<span class="p">{</span><span class="n">afile</span><span class="p">,</span><span class="n">bfile</span><span class="p">}</span>
<span class="err">$</span> <span class="n">scp</span> <span class="n">username</span><span class="o">@</span><span class="n">remotehost</span><span class="p">:</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">directory</span><span class="o">/</span> \<span class="p">{</span><span class="n">foo</span><span class="p">.</span><span class="n">txt</span> <span class="p">,</span> <span class="n">bar</span><span class="p">.</span><span class="n">txt</span>\<span class="p">}</span> <span class="p">.</span>
<span class="err">$</span> <span class="n">scp</span> <span class="n">root</span><span class="o">@</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.3</span><span class="p">:</span><span class="o">~/</span> \<span class="p">{</span><span class="n">abc</span><span class="p">.</span><span class="n">log</span> <span class="p">,</span> <span class="n">cde</span><span class="p">.</span><span class="n">txt</span>\<span class="p">}</span> <span class="p">.</span>
<span class="o">------------------------------------------------------------------------</span>
</pre></table></code></div></div><h3 id="rsync"><code class="language-plaintext highlighter-rouge">rsync</code></h3><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>
<span class="n">copy</span> <span class="nb">all</span> <span class="n">files</span> <span class="n">including</span> <span class="n">files</span> <span class="n">that</span> <span class="n">begin</span> <span class="k">with</span> <span class="p">.</span> <span class="p">(</span><span class="mi">1</span> <span class="n">dot</span><span class="p">)</span> <span class="k">from</span> <span class="n">one</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">another</span><span class="p">:</span>

    <span class="n">rsync</span> <span class="o">-</span><span class="n">a</span> <span class="p">.</span><span class="o">/</span> <span class="p">..</span><span class="o">/</span>


<span class="n">To</span> <span class="n">show</span> <span class="n">a</span> <span class="n">progress</span> <span class="n">bar</span> <span class="n">of</span> <span class="n">files</span> <span class="n">being</span> <span class="n">copied</span><span class="p">:</span>

    <span class="n">rsync</span> <span class="o">--</span><span class="n">progress</span> <span class="o">/</span><span class="n">copy</span><span class="o">/</span><span class="k">from</span> <span class="o">/</span><span class="n">copy</span><span class="o">/</span><span class="n">to</span>

</pre></table></code></div></div><hr /><h2 id="mv-moving-files-renaming-files"><code class="language-plaintext highlighter-rouge">mv</code> Moving Files, Renaming Files</h2><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>
<span class="n">Moving</span> <span class="n">Files</span>

    <span class="n">mv</span> <span class="n">currentpath</span><span class="o">/</span><span class="nb">file</span><span class="p">.</span><span class="n">txt</span> <span class="p">..</span><span class="o">/</span><span class="n">newpath</span>

<span class="n">Renaming</span> <span class="n">Files</span>

    <span class="n">mv</span> <span class="n">oldfilename</span><span class="p">.</span><span class="n">txt</span> <span class="n">newfilename</span><span class="p">.</span><span class="n">txt</span>
</pre></table></code></div></div><hr /><h2 id="compress-and-decompress">compress and decompress</h2><h3 id="zip"><code class="language-plaintext highlighter-rouge">zip</code></h3><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>
<span class="o">-</span><span class="n">r</span><span class="p">:</span> <span class="n">ensures</span> <span class="n">that</span> <span class="n">the</span> <span class="nb">file</span> <span class="ow">and</span> <span class="n">directories</span> <span class="n">within</span> <span class="n">the</span> <span class="n">parent</span> <span class="n">directory</span> <span class="n">being</span> <span class="n">compressed</span> <span class="n">are</span> <span class="n">also</span> <span class="n">included</span><span class="p">.</span>


<span class="n">Compressing</span> <span class="n">Files</span> <span class="k">with</span> <span class="n">Zip</span>

    <span class="nb">zip</span> <span class="o">-</span><span class="n">r</span> <span class="n">compressedfile</span><span class="p">.</span><span class="nb">zip</span> <span class="n">path</span><span class="o">/</span><span class="n">directoryname</span>

<span class="n">Decompressing</span> <span class="n">Zip</span> <span class="n">Files</span>

    <span class="n">unzip</span> <span class="n">filename</span><span class="p">.</span><span class="nb">zip</span>
</pre></table></code></div></div><h3 id="targz"><code class="language-plaintext highlighter-rouge">tar.gz</code></h3><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>
<span class="n">To</span> <span class="n">create</span> <span class="n">a</span> <span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="nb">file</span><span class="p">:</span>

    <span class="n">tar</span> <span class="n">czvf</span> <span class="n">archivename</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="n">directoryorfile</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">archive</span><span class="o">/</span>
    <span class="n">tar</span> <span class="n">czvf</span> <span class="n">website</span><span class="o">-</span><span class="n">backup</span><span class="o">-</span><span class="mi">2010</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mf">31.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="n">httpdocs</span><span class="o">/</span>

<span class="n">the</span> <span class="n">Flags</span> <span class="n">czvf</span><span class="p">:</span>
<span class="n">Compress</span> <span class="o">-</span> <span class="n">Creates</span> <span class="n">the</span> <span class="n">new</span> <span class="n">archive</span><span class="p">.</span>
<span class="n">Zip</span> <span class="o">-</span> <span class="n">Compresses</span> <span class="n">the</span> <span class="nb">file</span><span class="p">.</span>
<span class="n">File</span> <span class="o">-</span> <span class="n">Implies</span> <span class="n">that</span> <span class="n">we</span> <span class="n">have</span> <span class="n">given</span> <span class="n">the</span> <span class="n">compressed</span> <span class="nb">file</span> <span class="n">a</span> <span class="n">name</span><span class="p">.</span>
<span class="n">Verbose</span> <span class="o">-</span> <span class="n">Prints</span> <span class="n">what</span> <span class="n">the</span> <span class="n">command</span> <span class="n">line</span> <span class="ow">is</span> <span class="n">doing</span><span class="p">,</span> <span class="n">like</span> <span class="n">a</span> <span class="n">progress</span> <span class="n">report</span><span class="p">.</span>

<span class="n">Decompressing</span> <span class="n">Files</span> <span class="k">with</span> <span class="n">tar</span><span class="p">.</span><span class="n">gz</span>

    <span class="n">tar</span> <span class="o">-</span><span class="n">xzf</span> <span class="n">archivename</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
    <span class="n">tar</span> <span class="o">-</span><span class="n">xzf</span> <span class="n">website</span><span class="o">-</span><span class="n">backup</span><span class="o">-</span><span class="mi">2010</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mf">31.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>

</pre></table></code></div></div><hr /><h2 id="backing-up">Backing up</h2><h3 id="databases-mysqldump">Databases <code class="language-plaintext highlighter-rouge">mysqldump</code></h3><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>
<span class="n">To</span> <span class="n">backup</span> <span class="n">a</span> <span class="n">database</span> <span class="n">via</span> <span class="n">ssh</span><span class="p">:</span>

    <span class="n">mysqldump</span> <span class="o">-</span><span class="n">u</span> <span class="n">database_username</span> <span class="o">-</span><span class="n">p</span> <span class="n">database_name</span> <span class="o">&gt;</span> <span class="n">name_of_backup</span><span class="p">.</span><span class="n">sql</span>
    <span class="n">mysqldump</span> <span class="o">-</span><span class="n">u</span> <span class="n">wordpress_bob</span> <span class="o">-</span><span class="n">p</span> <span class="n">wordpress_blog</span> <span class="o">&gt;</span> <span class="n">wordpress_blog_20101031</span><span class="p">.</span><span class="n">sql</span>


<span class="n">To</span> <span class="n">restore</span> <span class="ow">and</span> <span class="kn">import</span> <span class="nn">a</span> <span class="n">database</span>
<span class="n">first</span> <span class="n">create</span> <span class="n">the</span> <span class="n">bank</span> <span class="n">database</span> <span class="n">then</span> <span class="n">assign</span> <span class="n">a</span> <span class="n">user</span><span class="p">.</span>
<span class="n">Using</span> <span class="n">these</span> <span class="n">details</span> <span class="n">you</span> <span class="n">must</span> <span class="n">replace</span> <span class="n">the</span> <span class="n">database</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">user</span> <span class="n">below</span><span class="p">:</span>

    <span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">database_username</span> <span class="o">-</span><span class="n">p</span> <span class="n">database_name</span> <span class="o">&lt;</span> <span class="n">name_of_backup</span><span class="p">.</span><span class="n">sql</span>
    <span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">wordpress_bob</span> <span class="o">-</span><span class="n">p</span> <span class="n">wordpress_blog</span> <span class="o">&lt;</span> <span class="n">wordpress_blog_2011</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mf">21.</span><span class="n">sql</span>


</pre></table></code></div></div><h3 id="backing-up-files-and-folders">Backing up Files and Folders</h3><p>To backup files, either use the compressing .tar.gz or .zip methods above.</p><hr /><h2 id="changing-and-setting-owner-group-ssh">Changing and Setting Owner Group SSH</h2><p>chown: change both the owner and group of a directory use the</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
<span class="n">chown</span> <span class="n">Owner</span><span class="p">:</span><span class="n">Group</span> <span class="n">directoryname</span><span class="o">/</span>
<span class="n">chown</span> <span class="mi">10000</span><span class="p">:</span><span class="mi">505</span> <span class="n">directoryname</span><span class="o">/</span>

</pre></table></code></div></div><hr /><h2 id="show-system-processes-with-ssh">Show System Processes with SSH</h2><p>To see what the system processes in a human readable way, type:</p><p><code class="language-plaintext highlighter-rouge">ps aux --forest</code></p><hr /><h2 id="get-the-last-30-lines-from-plesk-maillog">Get the last 30 lines from Plesk maillog</h2><p><code class="language-plaintext highlighter-rouge">tail -n 30 -f /usr/local/psa/var/log/maillog</code></p><hr /><h3 id="sshfs-挂载远程文件系统"><code class="language-plaintext highlighter-rouge">sshfs</code> 挂载远程文件系统</h3><p>基于 SSH 的工具: sshfs. 可以在本地直接挂载远程主机的文件系统. $ <code class="language-plaintext highlighter-rouge">sshfs</code> -o idmap=user <code class="language-plaintext highlighter-rouge">user@hostname:/home/user</code> <code class="language-plaintext highlighter-rouge">~/Remotefloder</code></p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 将远程主机 pi 用户的主目录 挂载到 本地主目录下的 Pi 文件夹.
</span><span class="err">$</span> <span class="n">sshfs</span> <span class="o">-</span><span class="n">o</span> <span class="n">idmap</span><span class="o">=</span><span class="n">user</span> <span class="n">pi</span><span class="o">@</span><span class="mf">10.42</span><span class="p">.</span><span class="mf">0.47</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span> <span class="o">~/</span><span class="n">Pi</span>
</pre></table></code></div></div><h3 id="ssh--x-x11-图形界面"><code class="language-plaintext highlighter-rouge">ssh -X</code> X11 图形界面</h3><p>假如现在你想要在远程主机运行一个图形界面的程序 用 SSH -X 连接到远程主机即可开启 X11 转发功能. 登录后你可能觉得没什么差别, 但是当你运行一个图形界面程序后就会发现其中的不同的.</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">X</span> <span class="n">pi</span><span class="o">@</span><span class="mf">10.42</span><span class="p">.</span><span class="mf">0.47</span>
<span class="err">$</span> <span class="n">pistore</span>
<span class="c1"># 如果想在运行图形界面程序的同时做些别的事情
# 只需在命令末尾加一个 &amp; 符号.
</span><span class="err">$</span> <span class="n">pistore</span><span class="o">&amp;</span>
</pre></table></code></div></div><hr /><h3 id="-d-绑定本地端口"><code class="language-plaintext highlighter-rouge">-D</code> 绑定本地端口</h3><p>既然SSH可以传送数据，那么可以让那些不加密的网络连接，全部走SSH连接，从而提高安全性。</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># 让8080端口的数据，都通过SSH传向远程主机，命令就这样写：
</span><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">D</span> <span class="mi">8080</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span>

<span class="c1"># SSH会建立一个socket，监听本地的8080端口。
# 一旦有数据传向那个端口，就自动把它转移到SSH连接上面，发往远程主机。
# 8080端口原来是一个不加密端口，现在将变成一个加密端口。
</span></pre></table></code></div></div><h3 id="-l-本地端口转发-local-forwarding"><code class="language-plaintext highlighter-rouge">-L</code> 本地端口转发 Local forwarding</h3><ul><li>有时，绑定本地端口还不够，还必须指定数据传送的目标主机，从而形成点对点的”端口转发”。<li>为了区别后文的”远程端口转发”，”本地端口转发”（Local forwarding）。</ul><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="n">假定host1本地主机</span><span class="err">，</span><span class="n">host2远程主机</span><span class="err">。</span><span class="n">种种原因这两台主机之间无法连通</span><span class="err">。</span>
<span class="n">host3可以同时连通前面两台主机</span><span class="err">。</span><span class="n">因此</span><span class="err">，</span><span class="n">通过host3</span><span class="err">，</span><span class="n">将host1连上host2</span><span class="err">。</span>

<span class="c1"># 在host1执行下面的命令：
</span><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">L</span> <span class="mi">2121</span><span class="p">:</span><span class="n">host2</span><span class="p">:</span><span class="mi">21</span> <span class="n">host3</span>

<span class="n">L参数一共接受三个值</span> <span class="s">"本地端口:目标主机:目标主机端口"</span>
<span class="n">指定SSH绑定本地端口2121</span><span class="err">，</span><span class="n">然后指定host3将所有数据</span><span class="err">，</span><span class="n">转发到目标主机host2的21端口</span><span class="err">（</span><span class="n">假定host2运行FTP端口21</span><span class="err">）</span>
<span class="n">这样一来</span><span class="err">，</span><span class="n">只要连接host1的2121端口</span><span class="err">，</span><span class="n">就等于连上了host2的21端口</span><span class="err">。</span>
<span class="err">$</span> <span class="n">ftp</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">2121</span>
<span class="s">"本地端口转发"</span><span class="n">使得host1和host3之间形成一个数据传输的秘密</span><span class="s">"SSH隧道"</span><span class="err">。</span>


<span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">L</span> <span class="mi">5900</span><span class="p">:</span><span class="n">localhost</span><span class="p">:</span><span class="mi">5900</span> <span class="n">host3</span>
<span class="c1"># 将本机的5900端口绑定host3的5900端口
</span><span class="n">里的localhost指的是host3</span><span class="err">，</span><span class="n">因为目标主机是相对host3而言的</span>


<span class="c1"># 通过host3的端口转发，ssh登录host2。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">L</span> <span class="mi">9001</span><span class="p">:</span><span class="n">host2</span><span class="p">:</span><span class="mi">22</span> <span class="n">host3</span>
<span class="c1"># 这时，只要ssh登录本机的9001端口，就相当于登录host2了。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">p</span> <span class="mi">9001</span> <span class="n">localhost</span>

<span class="n">上面的</span><span class="o">-</span><span class="n">p参数表示指定登录端口</span><span class="err">。</span>
<span class="n">出错处理</span><span class="err">：</span><span class="n">ssh</span><span class="p">:</span> <span class="n">Could</span> <span class="ow">not</span> <span class="n">resolve</span> <span class="n">hostname</span> <span class="mf">192.168</span><span class="p">.</span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="p">:</span><span class="o">***</span><span class="p">:</span> <span class="n">Name</span> <span class="ow">or</span> <span class="n">service</span> <span class="ow">not</span> <span class="n">known</span>
<span class="n">解决</span><span class="err">：</span><span class="n">指定端口不能直接使用ip</span><span class="p">:</span><span class="n">端口号</span><span class="err">，</span><span class="n">使用</span><span class="o">-</span><span class="n">p参数来解决就可以了</span><span class="err">。</span>

<span class="c1"># 从某主机的80端口开启到本地主机2001端口的隧道
</span><span class="n">ssh</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">L</span> <span class="mi">2001</span><span class="p">:</span><span class="n">localhost</span><span class="p">:</span><span class="mi">80</span> <span class="n">somemachine</span>
<span class="c1"># 现在可以直接在浏览器中输入http://localhost:2001访问这个网站。
</span>
</pre></table></code></div></div><h4 id="-r-远程端口转发-remote-forwarding"><code class="language-plaintext highlighter-rouge">-R</code> 远程端口转发 remote forwarding</h4><p>“本地端口转发”: 绑定本地端口的转发， “远程端口转发”: 绑定远程端口的转发。</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">host1与host2之间无法连通</span><span class="err">，</span><span class="n">必须借助host3转发</span><span class="err">。</span>
<span class="n">但是</span><span class="err">，</span><span class="n">host3是一台内网机器</span><span class="err">，</span><span class="n">它可以连接外网的host1</span><span class="err">，</span><span class="n">但是反过来外网的host1连不上内网的host3</span><span class="err">。</span>
<span class="n">这时</span><span class="err">，</span><span class="s">"本地端口转发"</span><span class="n">就不能用了</span>

<span class="n">解决办法</span>
<span class="n">host3可以连host1</span><span class="err">，</span><span class="n">那么就</span> <span class="s">"从host3上建立与host1的SSH连接"</span> <span class="err">，</span><span class="n">然后在host1上使用这条连接就可以了</span><span class="err">。</span>
<span class="n">在host3执行下面的命令</span><span class="err">：</span>
<span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">R</span> <span class="mi">2121</span><span class="p">:</span><span class="n">host2</span><span class="p">:</span><span class="mi">21</span> <span class="n">host1</span>

<span class="n">R参数也是接受三个值</span><span class="err">，</span><span class="n">分别是</span><span class="s">"远程主机端口:目标主机:目标主机端口"</span><span class="err">。</span>
<span class="n">让host1监听它自己的2121端口</span><span class="err">，</span><span class="n">然后将所有数据经由host3</span><span class="err">，</span><span class="n">转发到host2的21端口</span><span class="err">。</span>
<span class="n">由于对于host3来说</span><span class="err">，</span><span class="n">host1是远程主机</span><span class="err">，</span><span class="n">所以这种情况就被称为</span><span class="s">"远程端口绑定"</span><span class="err">。</span>

<span class="n">绑定之后</span><span class="err">，</span><span class="n">我们在host1就可以连接host2了</span><span class="err">：</span>
<span class="err">$</span> <span class="n">ftp</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">2121</span>
<span class="n">这里必须指出</span><span class="err">，</span><span class="s">"远程端口转发"</span><span class="n">的前提条件是</span><span class="err">，</span><span class="n">host1和host3两台主机都有sshD和ssh客户端</span><span class="err">。</span>
</pre></table></code></div></div><h4 id="ssh的其他参数">SSH的其他参数</h4><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
</pre><td class="rouge-code"><pre><span class="mf">1.</span>
<span class="n">N参数</span><span class="err">，</span><span class="n">表示只连接远程主机</span><span class="err">，</span><span class="n">不打开远程shell</span><span class="err">；</span>
<span class="n">T参数</span><span class="err">，</span><span class="n">表示不为这个连接分配TTY</span><span class="err">。</span>
<span class="c1"># 这两个参数放在一起用，代表这个SSH连接只用来传数据，不执行远程操作。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">NT</span> <span class="o">-</span><span class="n">D</span> <span class="mi">8080</span> <span class="n">host</span>

<span class="mf">2.</span> <span class="o">-</span><span class="n">f</span> <span class="c1"># 表示SSH连接成功后，转入后台运行。
# 这样一来，你就可以在不中断SSH连接的情况下，在本地shell中执行其他操作。
</span><span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">f</span> <span class="o">-</span><span class="n">D</span> <span class="mi">8080</span> <span class="n">host</span>
<span class="c1"># 要关闭这个后台连接，就只有用kill命令去杀掉进程。
</span>

<span class="mf">3.</span> <span class="n">将你的麦克风输出到远程计算机的扬声器</span>
<span class="c1"># 这样来自你麦克风端口的声音将在SSH目标计算机的扬声器端口输出，但声音质量很差，会听到很多嘶嘶声。
</span><span class="n">dd</span> <span class="k">if</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">dsp</span> <span class="o">|</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">c</span> <span class="n">arcfour</span> <span class="o">-</span><span class="n">C</span> <span class="n">username</span><span class="o">@</span><span class="n">host</span> <span class="n">dd</span> <span class="n">of</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">dsp</span>


<span class="mi">4</span><span class="err">、</span><span class="n">cat</span> <span class="n">fileA</span> <span class="o">|</span> <span class="n">diff</span> <span class="n">fileB</span> <span class="o">-</span> <span class="c1"># 比较远程和本地文件
</span><span class="err">$</span> <span class="n">ssh</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span> <span class="n">cat</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">remotefile</span> <span class="o">|</span> <span class="n">diff</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">localfile</span> <span class="err">–</span>
<span class="n">在比较本地文件和远程文件是否有差异时这个命令很管用</span><span class="err">。</span>

<span class="mi">5</span><span class="err">、</span><span class="n">通过SSH挂载目录</span><span class="o">/</span><span class="n">文件系统</span>
<span class="err">$</span> <span class="n">sshfs</span> <span class="n">name</span><span class="o">@</span><span class="n">server</span><span class="p">:</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">folder</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">mount</span><span class="o">/</span><span class="n">point</span>
<span class="n">从http</span><span class="p">:</span><span class="o">//</span><span class="n">fuse</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">sshfs</span><span class="p">.</span><span class="n">html下载sshfs</span><span class="err">，</span><span class="n">它允许你跨网络安全挂载一个目录</span><span class="err">。</span>

<span class="mi">6</span><span class="err">、</span><span class="n">通过中间主机建立SSH连接</span>
<span class="err">$</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">t</span> <span class="n">reachable_host</span> <span class="n">ssh</span> <span class="n">unreachable_host</span>
<span class="n">Unreachable_host表示从本地网络无法直接访问的主机</span><span class="err">，</span><span class="n">但可以从reachable_host所在网络访问</span><span class="err">，</span><span class="n">这个命令通过到reachable_host的</span><span class="err">“</span><span class="n">隐藏</span><span class="err">”</span><span class="n">连接</span><span class="err">，</span><span class="n">创建起到unreachable_host的连接</span><span class="err">。</span>


<span class="mi">8</span><span class="err">、</span><span class="n">直接连接到只能通过主机B连接的主机A</span>
<span class="n">ssh</span> <span class="o">-</span><span class="n">t</span> <span class="n">hostA</span> <span class="n">ssh</span> <span class="n">hostB</span>
<span class="n">当然</span><span class="err">，</span><span class="n">你要能访问主机A才行</span><span class="err">。</span>

<span class="mi">9</span><span class="err">、</span><span class="n">创建到目标主机的持久化连接</span>
<span class="n">ssh</span> <span class="o">-</span><span class="n">MNf</span> <span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;@&lt;</span><span class="n">host</span><span class="o">&gt;</span>
<span class="n">在后台创建到目标主机的持久化连接</span><span class="err">，</span><span class="n">将这个命令和你</span><span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">config中的配置结合使用</span><span class="err">：</span>
<span class="n">Host</span> <span class="n">host</span>
<span class="n">ControlPath</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">master</span><span class="o">-%</span><span class="n">r</span><span class="o">@%</span><span class="n">h</span><span class="p">:</span><span class="o">%</span><span class="n">p</span>
<span class="n">ControlMaster</span> <span class="n">no</span>
<span class="n">所有到目标主机的SSH连接都将使用持久化SSH套接字</span><span class="err">，</span><span class="n">如果你使用SSH定期同步文件</span><span class="err">（</span><span class="n">使用rsync</span><span class="o">/</span><span class="n">sftp</span><span class="o">/</span><span class="n">cvs</span><span class="o">/</span><span class="n">svn</span><span class="err">），</span><span class="n">这个命令将非常有用</span><span class="err">，</span><span class="n">因为每次打开一个SSH连接时不会创建新的套接字</span><span class="err">。</span>

<span class="mi">10</span><span class="err">、</span><span class="n">通过SSH连接屏幕</span>
<span class="n">ssh</span> <span class="o">-</span><span class="n">t</span> <span class="n">remote_host</span> <span class="n">screen</span> <span class="err">–</span><span class="n">r</span>
<span class="n">直接连接到远程屏幕会话</span><span class="err">（</span><span class="n">节省了无用的父bash进程</span><span class="err">）。</span>

<span class="mi">11</span><span class="err">、</span><span class="n">端口检测</span><span class="err">（</span><span class="n">敲门</span><span class="err">）</span>
<span class="n">knock</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span> <span class="mi">3000</span> <span class="mi">4000</span> <span class="mi">5000</span> <span class="o">&amp;&amp;</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span> <span class="n">user</span><span class="o">@</span><span class="n">host</span> <span class="o">&amp;&amp;</span> <span class="n">knock</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span> <span class="mi">5000</span> <span class="mi">4000</span> <span class="mi">3000</span>
<span class="n">在一个端口上敲一下打开某个服务的端口</span><span class="err">（</span><span class="n">如SSH</span><span class="err">），</span><span class="n">再敲一下关闭该端口</span><span class="err">，</span><span class="n">需要先安装knockd</span><span class="err">，</span><span class="n">下面是一个配置文件示例</span><span class="err">。</span>
<span class="p">[</span><span class="n">options</span><span class="p">]</span>
<span class="n">logfile</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">knockd</span><span class="p">.</span><span class="n">log</span>
<span class="p">[</span><span class="n">openSSH</span><span class="p">]</span>
<span class="n">sequence</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">5000</span>
<span class="n">seq_timeout</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">command</span> <span class="o">=</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">i</span> <span class="n">eth0</span> <span class="o">-</span><span class="n">s</span> <span class="o">%</span><span class="n">IP</span><span class="o">%</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="err">–</span><span class="n">dport</span> <span class="mi">22</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">tcpflags</span> <span class="o">=</span> <span class="n">syn</span>
<span class="p">[</span><span class="n">closeSSH</span><span class="p">]</span>
<span class="n">sequence</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">3000</span>
<span class="n">seq_timeout</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">command</span> <span class="o">=</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">iptables</span> <span class="o">-</span><span class="n">D</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">i</span> <span class="n">eth0</span> <span class="o">-</span><span class="n">s</span> <span class="o">%</span><span class="n">IP</span><span class="o">%</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="err">–</span><span class="n">dport</span> <span class="mi">22</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">tcpflags</span> <span class="o">=</span> <span class="n">syn</span>


<span class="mi">12</span><span class="err">、</span><span class="n">删除文本文件中的一行内容</span><span class="err">，</span><span class="n">有用的修复</span>
<span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">R</span> <span class="o">&lt;</span><span class="n">the_offending_host</span><span class="o">&gt;</span>
<span class="n">在这种情况下</span><span class="err">，</span><span class="n">最好使用专业的工具</span><span class="err">。</span>

<span class="mi">13</span><span class="err">、</span><span class="n">通过SSH运行复杂的远程shell命令</span>
<span class="n">ssh</span> <span class="n">host</span> <span class="o">-</span><span class="n">l</span> <span class="n">user</span> <span class="err">$</span><span class="p">(</span><span class="o">&lt;</span><span class="n">cmd</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span>
<span class="n">更具移植性的版本</span><span class="err">：</span>
<span class="n">ssh</span> <span class="n">host</span> <span class="o">-</span><span class="n">l</span> <span class="n">user</span> <span class="err">“</span><span class="sb">`cat cmd.txt`</span><span class="err">”</span>

<span class="mi">14</span><span class="err">、</span><span class="n">通过SSH将MySQL数据库复制到新服务器</span>
<span class="n">mysqldump</span> <span class="err">–</span><span class="n">add</span><span class="o">-</span><span class="n">drop</span><span class="o">-</span><span class="n">table</span> <span class="err">–</span><span class="n">extended</span><span class="o">-</span><span class="n">insert</span> <span class="err">–</span><span class="n">force</span> <span class="err">–</span><span class="n">log</span><span class="o">-</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">.</span><span class="n">log</span> <span class="o">-</span><span class="n">uUSER</span> <span class="o">-</span><span class="n">pPASS</span> <span class="n">OLD_DB_NAME</span> <span class="o">|</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">C</span> <span class="n">user</span><span class="o">@</span><span class="n">newhost</span> <span class="err">“</span><span class="n">mysql</span> <span class="o">-</span><span class="n">uUSER</span> <span class="o">-</span><span class="n">pPASS</span> <span class="n">NEW_DB_NAME</span><span class="err">”</span>
<span class="n">通过压缩的SSH隧道Dump一个MySQL数据库</span><span class="err">，</span><span class="n">将其作为输入传递给mysql命令</span><span class="err">，</span><span class="n">我认为这是迁移数据库到新服务器最快最好的方法</span><span class="err">。</span>

<span class="mi">15</span><span class="err">、</span><span class="n">删除文本文件中的一行</span><span class="err">，</span><span class="n">修复</span><span class="err">“</span><span class="n">SSH主机密钥更改</span><span class="err">”</span><span class="n">的警告</span>
<span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="mi">8</span><span class="n">d</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">known_hosts</span>

<span class="mi">16</span><span class="err">、</span><span class="n">从一台没有SSH</span><span class="o">-</span><span class="n">COPY</span><span class="o">-</span><span class="n">ID命令的主机将你的SSH公钥复制到服务器</span>
<span class="n">cat</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span> <span class="o">|</span> <span class="n">ssh</span> <span class="n">user</span><span class="o">@</span><span class="n">machine</span> <span class="err">“</span><span class="n">mkdir</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="p">;</span> <span class="n">cat</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">authorized_keys</span><span class="err">”</span>
<span class="n">如果你使用Mac</span> <span class="n">OS</span> <span class="n">X或其它没有ssh</span><span class="o">-</span><span class="n">copy</span><span class="o">-</span><span class="n">id命令的</span><span class="o">*</span><span class="n">nix变种</span><span class="err">，</span><span class="n">这个命令可以将你的公钥复制到远程主机</span><span class="err">，</span><span class="n">因此你照样可以实现无密码SSH登录</span><span class="err">。</span>

<span class="mi">17</span><span class="err">、</span><span class="n">实时SSH网络吞吐量测试</span>
<span class="n">yes</span> <span class="o">|</span> <span class="n">pv</span> <span class="o">|</span> <span class="n">ssh</span> <span class="err">$</span><span class="n">host</span> <span class="err">“</span><span class="n">cat</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span><span class="err">”</span>
<span class="n">通过SSH连接到主机</span><span class="err">，</span><span class="n">显示实时的传输速度</span><span class="err">，</span><span class="n">将所有传输数据指向</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span><span class="err">，</span><span class="n">需要先安装pv</span><span class="err">。</span>
<span class="n">如果是Debian</span><span class="err">：</span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">pv</span>
<span class="n">如果是Fedora</span><span class="err">：</span><span class="n">yum</span> <span class="n">install</span> <span class="n">pv</span>
<span class="err">（</span><span class="n">可能需要启用额外的软件仓库</span><span class="err">）。</span>

<span class="mi">18</span><span class="err">、</span><span class="n">如果建立一个可以重新连接的远程GNU</span> <span class="n">screen</span>
<span class="n">ssh</span> <span class="o">-</span><span class="n">t</span> <span class="n">user</span><span class="o">@</span><span class="n">some</span><span class="p">.</span><span class="n">domain</span><span class="p">.</span><span class="n">com</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">screen</span> <span class="err">–</span><span class="n">xRR</span>
<span class="n">人们总是喜欢在一个文本终端中打开许多shell</span><span class="err">，</span><span class="n">如果会话突然中断</span><span class="err">，</span><span class="n">或你按下了</span><span class="err">“</span><span class="n">Ctrl</span><span class="o">-</span><span class="n">a</span> <span class="n">d</span><span class="err">”，</span><span class="n">远程主机上的shell不会受到丝毫影响</span><span class="err">，</span><span class="n">你可以重新连接</span><span class="err">，</span><span class="n">其它有用的screen命令有</span><span class="err">“</span><span class="n">Ctrl</span><span class="o">-</span><span class="n">a</span> <span class="n">c</span><span class="err">”（</span><span class="n">打开新的shell</span><span class="err">）</span><span class="n">和</span><span class="err">“</span><span class="n">Ctrl</span><span class="o">-</span><span class="n">a</span> <span class="n">a</span><span class="err">”（</span><span class="n">在shell之间来回切换</span><span class="err">），</span><span class="n">请访问http</span><span class="p">:</span><span class="o">//</span><span class="n">aperiodic</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">screen</span><span class="o">/</span><span class="n">quick_reference阅读更多关于screen命令的快速参考</span><span class="err">。</span>

<span class="mi">19</span><span class="err">、</span><span class="n">继续SCP大文件</span>
<span class="n">rsync</span> <span class="err">–</span><span class="n">partial</span> <span class="err">–</span><span class="n">progress</span> <span class="err">–</span><span class="n">rsh</span><span class="o">=</span><span class="n">ssh</span> <span class="err">$</span><span class="n">file_source</span> <span class="err">$</span><span class="n">user</span><span class="o">@</span><span class="err">$</span><span class="n">host</span><span class="p">:</span><span class="err">$</span><span class="n">destination_file</span>
<span class="n">它可以恢复失败的rsync命令</span><span class="err">，</span><span class="n">当你通过VPN传输大文件</span><span class="err">，</span><span class="n">如备份的数据库时这个命令非常有用</span><span class="err">，</span><span class="n">需要在两边的主机上安装rsync</span><span class="err">。</span>
<span class="n">rsync</span> <span class="err">–</span><span class="n">partial</span> <span class="err">–</span><span class="n">progress</span> <span class="err">–</span><span class="n">rsh</span><span class="o">=</span><span class="n">ssh</span> <span class="err">$</span><span class="n">file_source</span> <span class="err">$</span><span class="n">user</span><span class="o">@</span><span class="err">$</span><span class="n">host</span><span class="p">:</span><span class="err">$</span><span class="n">destination_file</span> <span class="n">local</span> <span class="o">-&gt;</span> <span class="n">remote</span>
<span class="n">或</span>
<span class="n">rsync</span> <span class="err">–</span><span class="n">partial</span> <span class="err">–</span><span class="n">progress</span> <span class="err">–</span><span class="n">rsh</span><span class="o">=</span><span class="n">ssh</span> <span class="err">$</span><span class="n">user</span><span class="o">@</span><span class="err">$</span><span class="n">host</span><span class="p">:</span><span class="err">$</span><span class="n">remote_file</span> <span class="err">$</span><span class="n">destination_file</span> <span class="n">remote</span> <span class="o">-&gt;</span> <span class="n">local</span>

<span class="mi">20</span><span class="err">、</span><span class="n">通过SSH</span> <span class="n">W</span><span class="o">/</span> <span class="n">WIRESHARK分析流量</span>
<span class="n">ssh</span> <span class="n">root</span><span class="o">@</span><span class="n">server</span><span class="p">.</span><span class="n">com</span> <span class="err">‘</span><span class="n">tshark</span> <span class="o">-</span><span class="n">f</span> <span class="err">“</span><span class="n">port</span> <span class="err">!</span><span class="mi">22</span><span class="err">″</span> <span class="o">-</span><span class="n">w</span> <span class="o">-</span><span class="s">' | wireshark -k -i –
使用tshark捕捉远程主机上的网络通信，通过SSH连接发送原始pcap数据，并在wireshark中显示，按下Ctrl+C将停止捕捉，但也会关闭wireshark窗口，可以传递一个“-c # ”参数给tshark，让它只捕捉“#”指定的数据包类型，或通过命名管道重定向数据，而不是直接通过SSH传输给wireshark，我建议你过滤数据包，以节约带宽，tshark可以使用tcpdump替代：
ssh root@example.com tcpdump -w – ‘port !22′ | wireshark -k -i –


21、保持SSH会话永久打开
autossh -M50000 -t server.example.com ‘screen -raAd mysession’
打开一个SSH会话后，让其保持永久打开，对于使用笔记本电脑的用户，如果需要在Wi-Fi热点之间切换，可以保证切换后不会丢失连接。


22、更稳定，更快，更强的SSH客户端
ssh -4 -C -c blowfish-cbc
强制使用IPv4，压缩数据流，使用Blowfish加密。


23、使用cstream控制带宽
tar -cj /backup | cstream -t 777k | ssh host ‘tar -xj -C /backup’
使用bzip压缩文件夹，然后以777k bit/s速率向远程主机传输。Cstream还有更多的功能，请访问http://www.cons.org/cracauer/cstream.html#usage了解详情，例如：
echo w00t, i’m 733+ | cstream -b1 -t2


24、一步将SSH公钥传输到另一台机器
ssh-keygen; ssh-copy-id user@host; ssh user@host
这个命令组合允许你无密码SSH登录，注意，如果在本地机器的~/.ssh目录下已经有一个SSH密钥对，ssh-keygen命令生成的新密钥可能会覆盖它们，ssh-copy-id将密钥复制到远程主机，并追加到远程账号的~/.ssh/authorized_keys文件中，使用SSH连接时，如果你没有使用密钥口令，调用ssh user@host后不久就会显示远程shell。


25、将标准输入（stdin）复制到你的X11缓冲区
ssh user@host cat /path/to/some/file | xclip
你是否使用scp将文件复制到工作用电脑上，以便复制其内容到电子邮件中？xclip可以帮到你，它可以将标准输入复制到X11缓冲区，你需要做的就是点击鼠标中键粘贴缓冲区中的内容。
</span></pre></table></code></div></div><p>总结</p><ul><li>尽管SCP在安全地传输文件方面是非常有效的，它缺乏文件同步工具必要的功能。它所能做的就是复制粘贴文件从一个位置到另一个位置。<li>一个更强大的工具的 <code class="language-plaintext highlighter-rouge">Rsync</code> 它不仅具有SCP的所有功能，而且增加了更多的功能用来在2个主机智能同步文件。例如，它可以检查并上传只有修改过的文件，忽略现有的文件等等。</ul><hr /><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/31linux/'>31Linux</a>, <a href='/categories/commandtool/'>CommandTool</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/commandtool/" class="post-tag no-text-decoration" >CommandTool</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >SSH</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CommandList - SSH - Grace&url=https://ocholuo.github.io//posts/Linux.SSH/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CommandList - SSH - Grace&u=https://ocholuo.github.io//posts/Linux.SSH/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=CommandList - SSH - Grace&url=https://ocholuo.github.io//posts/Linux.SSH/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://ocholuo.github.io//posts/Linux.SSH/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ml/">ML - Intro to Machine Learning</a><li><a href="/posts/ml-1/">ML - Intro to Machine Learning</a><li><a href="/posts/ml-2/">ML - Intermediate Machine Learning</a><li><a href="/posts/ml-lab-01-Titanic-ML-from-Disaster/">ML lab - Titanic-ML-from-Disaster</a><li><a href="/posts/ml-lab-02-Homedata/">ML lab - Home data</a><li><a href="/posts/panda/">Python - Panda Library</a><li><a href="/posts/CourseREADME/">Course - Learning Path</a><li><a href="/posts/pyWork/">python workflow</a><li><a href="/posts/pythonCrash/">Python Crash</a><li><a href="/posts/Cloud-loadbalance/">GCP - Cloud Load balance</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/soc/">SOC</a> <a class="post-tag" href="/tags/network/">Network</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CRON/"><div class="card-body"> <span class="timeago small" > Jul 16, 2020 <i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CommandList - cron</h3><div class="text-muted small"><p> cron [toc] basic Cron command for periodic processing. Periodic processing is necessary to make sure systems are functioning correctly. Cron is our scheduler. to execute anything, arbitra...</p></div></div></a></div><div class="card"> <a href="/posts/CommandList-Socket/"><div class="card-body"> <span class="timeago small" > Jul 16, 2020 <i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CommandList - Socket</h3><div class="text-muted small"><p> Linux Socket [toc] 1. 网络中进程之间通信 我们深谙信息交流的价值，那网络中进程之间如何通信，如我们每天打开浏览器浏览网页时，浏览器的进程怎么与web服务器通信的？当你用QQ聊天时，QQ进程怎么与服务器或你好友所在的QQ进程通信？这些都得靠socket？那什么是socket？socket的类型有哪些？还有socket的基本函数 本地的进程间通信（IPC）有很多...</p></div></div></a></div><div class="card"> <a href="/posts/Linux.git/"><div class="card-body"> <span class="timeago small" > Jul 16, 2020 <i class="unloaded">2020-07-16T11:11:11-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CommandList - git</h3><div class="text-muted small"><p> git [toc] git 常用命令详解 ref https://www.jianshu.com/p/d220c88bb516 https://www.yiibai.com/git/git_basic_concepts.html https://www.softwhy.com/article-8699-1.html https://www.yiibai.com/git/git_comm...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Linux-Sysfile/" class="btn btn-outline-primary" prompt="Older"><p>Linux - Sysfile</p></a> <a href="/posts/Linux.git/" class="btn btn-outline-primary" prompt="Newer"><p>CommandList - git</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//https-ocholuo-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'CommandList - SSH'; this.page.url = 'https://ocholuo.github.io//posts/Linux.SSH/'; this.page.identifier = '/posts/Linux.SSH/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/ocholuo">Grace JyL</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/cyberattack/">CyberAttack</a> <a class="post-tag" href="/tags/cyberattacktools/">CyberAttackTools</a> <a class="post-tag" href="/tags/lab/">Lab</a> <a class="post-tag" href="/tags/gcp/">GCP</a> <a class="post-tag" href="/tags/sysadmin/">Sysadmin</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/soc/">SOC</a> <a class="post-tag" href="/tags/network/">Network</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ocholuo.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
